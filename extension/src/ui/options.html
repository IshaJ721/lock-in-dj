<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lock In DJ - Settings</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body style="background: #0f0f0f; min-height: 100vh;">
  <div class="options-container">
    <h1>Lock In DJ Settings</h1>

    <!-- Music Service -->
    <div class="options-section">
      <h2>Music Service</h2>
      <p style="font-size: 13px; color: #888; margin-bottom: 16px;">
        Open YouTube Music in a browser tab. Lock In DJ will control playback automatically.
      </p>
      <button id="open-ytmusic" class="btn-save" style="background: #ff0000;">
        Open YouTube Music
      </button>
    </div>

    <!-- Site Lists -->
    <div class="options-section">
      <h2>Site Configuration</h2>

      <div class="form-group">
        <label>Study Sites (productive)</label>
        <textarea id="study-sites" placeholder="docs.google.com&#10;notion.so&#10;github.com"></textarea>
        <p style="font-size: 11px; color: #666; margin-top: 4px;">One domain per line. Time on these sites improves your focus score.</p>
      </div>

      <div class="form-group">
        <label>Doomscroll Sites (distracting)</label>
        <textarea id="doomscroll-sites" placeholder="twitter.com&#10;instagram.com&#10;reddit.com"></textarea>
        <p style="font-size: 11px; color: #666; margin-top: 4px;">One domain per line. Time on these sites hurts your focus score.</p>
      </div>
    </div>

    <!-- Behavior -->
    <div class="options-section">
      <h2>Intervention Behavior</h2>

      <div class="form-group toggle-group">
        <div>
          <label style="margin: 0;">Enable Nuclear Option</label>
          <p style="font-size: 11px; color: #666; margin-top: 2px;">Max volume blast when doomscrolling in strict mode</p>
        </div>
        <label class="toggle">
          <input type="checkbox" id="nuclear-enabled">
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div style="margin-top: 16px;" class="form-group toggle-group">
        <div>
          <label style="margin: 0;">Enable Pomodoro</label>
          <p style="font-size: 11px; color: #666; margin-top: 2px;">Structured work/break cycles</p>
        </div>
        <label class="toggle">
          <input type="checkbox" id="pomodoro-enabled">
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div id="pomodoro-settings" style="margin-top: 16px; display: none;">
        <div class="form-group">
          <label>Work Duration (minutes)</label>
          <input type="number" id="pomodoro-work" value="25" min="5" max="60">
        </div>
        <div class="form-group">
          <label>Break Duration (minutes)</label>
          <input type="number" id="pomodoro-break" value="5" min="1" max="30">
        </div>
      </div>
    </div>

    <!-- Focus Model -->
    <div class="options-section">
      <h2>Focus Detection</h2>
      <p style="font-size: 13px; color: #888; margin-bottom: 16px;">
        The system tracks tab switches and time on blocked sites. These signals are combined into a 0-100 focus score.
      </p>

      <div class="form-group">
        <label>Tab Switch Sensitivity</label>
        <select id="tab-sensitivity" style="width: 100%; padding: 10px; background: #0f0f0f; border: 1px solid #333; border-radius: 8px; color: #e5e5e5;">
          <option value="low">Low (15+ switches = penalty)</option>
          <option value="normal" selected>Normal (10+ switches = penalty)</option>
          <option value="high">High (5+ switches = penalty)</option>
        </select>
      </div>
    </div>

    <!-- AI Music Recommendations -->
    <div class="options-section">
      <h2>AI Music Recommendations</h2>
      <p style="font-size: 13px; color: #888; margin-bottom: 16px;">
        Connect AI services for personalized music recommendations based on your focus patterns.
        API keys are stored locally and never sent to our servers.
      </p>

      <div class="form-group">
        <label>Groq API Key</label>
        <div style="display: flex; gap: 8px;">
          <input type="password" id="groq-api-key" placeholder="gsk_..." style="flex: 1; padding: 10px; background: #0f0f0f; border: 1px solid #333; border-radius: 8px; color: #e5e5e5;">
          <button id="toggle-groq-key" style="padding: 10px 14px; background: #1a1a1a; border: 1px solid #333; border-radius: 8px; cursor: pointer; color: #888;">Show</button>
        </div>
        <p style="font-size: 11px; color: #666; margin-top: 4px;">
          Get your free API key at <a href="https://console.groq.com" target="_blank" style="color: #ff6b9d;">console.groq.com</a>
        </p>
        <div id="groq-status" style="margin-top: 4px; font-size: 12px;"></div>
      </div>

      <div class="form-group" style="margin-top: 16px;">
        <label>SERP API Key (Optional)</label>
        <div style="display: flex; gap: 8px;">
          <input type="password" id="serp-api-key" placeholder="Your SERP API key" style="flex: 1; padding: 10px; background: #0f0f0f; border: 1px solid #333; border-radius: 8px; color: #e5e5e5;">
          <button id="toggle-serp-key" style="padding: 10px 14px; background: #1a1a1a; border: 1px solid #333; border-radius: 8px; cursor: pointer; color: #888;">Show</button>
        </div>
        <p style="font-size: 11px; color: #666; margin-top: 4px;">
          Enables BPM lookup and music discovery. Get a key at <a href="https://serpapi.com" target="_blank" style="color: #ff6b9d;">serpapi.com</a>
        </p>
        <div id="serp-status" style="margin-top: 4px; font-size: 12px;"></div>
      </div>

      <button id="test-apis" class="btn-save" style="background: #333; margin-top: 16px;">
        Test API Connections
      </button>
    </div>

    <!-- Music Intelligence -->
    <div class="options-section">
      <h2>Music Intelligence</h2>
      <p style="font-size: 13px; color: #888; margin-bottom: 16px;">
        Your personalized music-focus correlation model learns which BPM ranges help you focus best.
      </p>

      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px;">
        <div style="background: #1a1a1a; border-radius: 8px; padding: 16px; text-align: center;">
          <span id="tracks-analyzed" style="display: block; font-size: 24px; font-weight: 600; color: #ff6b9d;">0</span>
          <span style="font-size: 11px; color: #666;">Tracks Analyzed</span>
        </div>
        <div style="background: #1a1a1a; border-radius: 8px; padding: 16px; text-align: center;">
          <span id="optimal-bpm" style="display: block; font-size: 24px; font-weight: 600; color: #ff6b9d;">--</span>
          <span style="font-size: 11px; color: #666;">Optimal BPM</span>
        </div>
        <div style="background: #1a1a1a; border-radius: 8px; padding: 16px; text-align: center;">
          <span id="top-genre" style="display: block; font-size: 24px; font-weight: 600; color: #ff6b9d;">--</span>
          <span style="font-size: 11px; color: #666;">Top Genre</span>
        </div>
      </div>

      <div class="form-group toggle-group">
        <div>
          <label style="margin: 0;">Auto Music Switch</label>
          <p style="font-size: 11px; color: #666; margin-top: 2px;">Automatically change music when focus drops below threshold</p>
        </div>
        <label class="toggle">
          <input type="checkbox" id="auto-music-switch" checked>
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div class="form-group" style="margin-top: 16px;">
        <label>Focus Threshold for Auto Switch</label>
        <div style="display: flex; align-items: center; gap: 12px;">
          <input type="range" id="auto-music-threshold" min="30" max="70" value="50" style="flex: 1;">
          <span id="threshold-value" style="min-width: 40px; text-align: center; font-weight: 600;">50</span>
        </div>
        <p style="font-size: 11px; color: #666; margin-top: 4px;">Music will change when focus score drops below this level</p>
      </div>

      <div class="form-group" style="margin-top: 16px;">
        <label>Preferred Music Genres</label>
        <p style="font-size: 11px; color: #666; margin-bottom: 8px;">Select genres you enjoy for focus music</p>
        <div id="genre-checkboxes" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
          <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px; background: #1a1a1a; border-radius: 6px;">
            <input type="checkbox" value="lofi" class="genre-checkbox"> Lofi
          </label>
          <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px; background: #1a1a1a; border-radius: 6px;">
            <input type="checkbox" value="jazz" class="genre-checkbox"> Jazz
          </label>
          <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px; background: #1a1a1a; border-radius: 6px;">
            <input type="checkbox" value="classical" class="genre-checkbox"> Classical
          </label>
          <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px; background: #1a1a1a; border-radius: 6px;">
            <input type="checkbox" value="electronic" class="genre-checkbox"> Electronic
          </label>
          <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px; background: #1a1a1a; border-radius: 6px;">
            <input type="checkbox" value="synthwave" class="genre-checkbox"> Synthwave
          </label>
          <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px; background: #1a1a1a; border-radius: 6px;">
            <input type="checkbox" value="ambient" class="genre-checkbox"> Ambient
          </label>
          <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px; background: #1a1a1a; border-radius: 6px;">
            <input type="checkbox" value="instrumental" class="genre-checkbox"> Instrumental
          </label>
          <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px; background: #1a1a1a; border-radius: 6px;">
            <input type="checkbox" value="rock" class="genre-checkbox"> Rock
          </label>
          <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px; background: #1a1a1a; border-radius: 6px;">
            <input type="checkbox" value="pop" class="genre-checkbox"> Pop
          </label>
        </div>
      </div>

      <div class="form-group toggle-group" style="margin-top: 16px;">
        <div>
          <label style="margin: 0;">Enable AI Recommendations</label>
          <p style="font-size: 11px; color: #666; margin-top: 2px;">Use learned patterns to recommend focus-optimal tracks</p>
        </div>
        <label class="toggle">
          <input type="checkbox" id="ai-recommendations-enabled" checked>
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div id="bpm-model-details" style="margin-top: 16px; padding: 12px; background: #1a1a1a; border-radius: 8px; font-size: 12px; color: #888;">
        <p>BPM correlation data will appear here as you listen to music.</p>
      </div>

      <button id="clear-music-data" class="btn-save" style="background: #ef4444; margin-top: 16px;">
        Clear Music Learning Data
      </button>
    </div>

    <!-- Privacy -->
    <div class="options-section">
      <h2>Privacy</h2>
      <p style="font-size: 13px; color: #888; margin-bottom: 16px;">
        Lock In DJ processes all data locally. No browsing history or personal data is sent anywhere.
      </p>

      <div style="background: #1a2e1a; border: 1px solid #2d4a2d; border-radius: 8px; padding: 12px; margin-bottom: 16px;">
        <p style="font-size: 12px; color: #4ade80; margin: 0;">
          ✓ All focus detection happens on-device<br>
          ✓ No URLs or page content is stored<br>
          ✓ Learning model stays in your browser
        </p>
      </div>

      <button id="clear-history" class="btn-save" style="background: #ef4444;">
        Reset Learning Model
      </button>
      <p style="font-size: 11px; color: #666; margin-top: 4px;">This clears intervention history and resets what works for you.</p>
    </div>

    <!-- Save -->
    <button id="save-settings" class="btn-save">
      Save Settings
    </button>
  </div>

  <script src="options.js" type="module"></script>
</body>
</html>
