<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FocusDJ</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="popup">
    <!-- Header -->
    <header class="header">
      <h1>FocusDJ</h1>
      <span class="version">v0.1</span>
    </header>

    <!-- Music Connection -->
    <div id="music-section" class="section">
      <div id="music-disconnected" class="music-status">
        <p>Open YouTube Music to enable interventions</p>
        <button id="open-ytmusic" class="btn btn-ytmusic">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
            <path d="M12 0C5.376 0 0 5.376 0 12s5.376 12 12 12 12-5.376 12-12S18.624 0 12 0zm0 19.104c-3.924 0-7.104-3.18-7.104-7.104S8.076 4.896 12 4.896s7.104 3.18 7.104 7.104-3.18 7.104-7.104 7.104zm0-13.332c-3.432 0-6.228 2.796-6.228 6.228S8.568 18.228 12 18.228 18.228 15.432 18.228 12 15.432 5.772 12 5.772zM9.684 15.54V8.46L15.816 12l-6.132 3.54z"/>
          </svg>
          Open YouTube Music
        </button>
      </div>
      <div id="music-connected" class="music-status hidden">
        <div class="now-playing">
          <img id="album-art" src="" alt="" class="album-art">
          <div class="track-info">
            <p id="track-name" class="track-name">Not playing</p>
            <p id="artist-name" class="artist-name"></p>
          </div>
          <div class="playback-controls">
            <button id="prev-btn" class="control-btn" title="Previous">⏮</button>
            <button id="play-pause-btn" class="control-btn" title="Play/Pause">⏯</button>
            <button id="next-btn" class="control-btn" title="Next">⏭</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Focus Score -->
    <div id="focus-section" class="section">
      <div class="focus-display">
        <div class="focus-score-container">
          <svg class="focus-ring" viewBox="0 0 100 100">
            <circle class="ring-bg" cx="50" cy="50" r="45" />
            <circle id="focus-ring" class="ring-progress" cx="50" cy="50" r="45" />
          </svg>
          <div class="focus-score-text">
            <span id="focus-score">--</span>
          </div>
        </div>
        <div class="focus-label">
          <span id="focus-status">Not active</span>
          <span id="focus-trend" class="trend"></span>
        </div>
      </div>
      <!-- Current Site & Penalties -->
      <div id="focus-details" class="focus-details hidden">
        <div id="current-site" class="current-site"></div>
        <div id="penalty-list" class="penalty-list"></div>
      </div>
    </div>

    <!-- Session Controls -->
    <div id="controls-section" class="section">
      <div id="session-inactive" class="session-controls">
        <p class="hint">Select intensity and start session</p>
        <div class="mode-selector">
          <button class="mode-btn" data-mode="gentle">Gentle</button>
          <button class="mode-btn active" data-mode="normal">Normal</button>
          <button class="mode-btn" data-mode="strict">Strict</button>
        </div>
        <button id="start-session" class="btn btn-primary btn-large">
          Start Session
        </button>
      </div>
      <div id="session-active" class="session-controls hidden">
        <div class="session-info">
          <span id="session-mode" class="mode-badge">Normal</span>
          <span id="session-time" class="session-time">00:00</span>
        </div>
        <!-- Pomodoro Timer -->
        <div id="pomodoro-section" class="pomodoro-display hidden">
          <div class="pomodoro-timer">
            <span id="pomodoro-phase" class="pomodoro-phase">Focus</span>
            <span id="pomodoro-time" class="pomodoro-time">25:00</span>
          </div>
          <div class="pomodoro-controls">
            <button id="pomodoro-toggle" class="btn-icon" title="Start/Stop Pomodoro">
              <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </button>
          </div>
        </div>
        <button id="stop-session" class="btn btn-danger">
          End Session
        </button>
      </div>
    </div>

    <!-- Intervention Log -->
    <div id="intervention-section" class="section hidden">
      <p id="last-intervention" class="intervention-msg"></p>
    </div>

    <!-- Dashboard Button -->
    <div id="dashboard-section" class="section">
      <button id="open-dashboard" class="btn btn-dashboard">
        Open FocusDJ Dashboard
      </button>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <button id="open-camera" class="btn-link" title="Vision Focus Detection">
        <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
          <circle cx="12" cy="13" r="4"/>
        </svg>
        <span id="camera-status">Camera</span>
      </button>
      <button id="toggle-nuclear" class="btn-link">
        <span id="nuclear-status">Nuclear: Off</span>
      </button>
    </footer>
  </div>

  <script src="popup.js" type="module"></script>
</body>
</html>
